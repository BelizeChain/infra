version: '3.8'

services:
  belizechain-node:
    image: belizechain/node:latest
    build:
      context: ../
      dockerfile: belizechain/Dockerfile
    container_name: belizechain-node-standalone
    ports:
      - "30333:30333"  # P2P
      - "9933:9933"    # HTTP RPC
      - "9944:9944"    # WebSocket RPC
      - "9615:9615"    # Prometheus metrics
    volumes:
      - blockchain-data:/data
    environment:
      - RUST_LOG=info,runtime=debug
      - BELIZECHAIN_CHAIN=dev
      - BELIZECHAIN_BASE_PATH=/data
      - NODE_NAME=BelizeChain-Standalone
    command: >
      --dev
      --base-path /data
      --rpc-external
      --rpc-cors all
      --ws-external
      --prometheus-external
      --name BelizeChain-Standalone
    healthcheck:
      test: ["CMD", "curl", "-f", "http://localhost:9933/health"]
      interval: 30s
      timeout: 10s
      retries: 5
      start_period: 60s
    restart: unless-stopped
    networks:
      - belizechain-net

volumes:
  blockchain-data:
    driver: local

networks:
  belizechain-net:
    driver: bridge
    ipam:
      config:
        - subnet: 172.21.0.0/16
